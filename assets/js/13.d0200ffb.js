(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{180:function(e,t,i){"use strict";i.r(t);var s=i(0),n=Object(s.a)({},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"content"},[e._m(0),e._v(" "),e._m(1),e._v(" "),i("p",[i("a",{attrs:{href:"https://www.configserver.com/cp/csf.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ConfigServer Security & Firewall (CSF)"),i("OutboundLink")],1),e._v(" integration is intended to allow to use CSF along with Imunify360.")]),e._v(" "),e._m(2),e._v(" "),e._m(3),e._v(" "),i("p",[e._v("If CSF is "),i("strong",[e._v("enabled")]),e._v(" Imunify360 uses Login Failure Daemon (LFD) as source for security events instead of "),i("a",{attrs:{href:"https://www.ossec.net",target:"_blank",rel:"noopener noreferrer"}},[e._v("OSSEC"),i("OutboundLink")],1),e._v(". CSF integration is enabled automatically when Imunify360 detects that CSF is running. No additional configuration is needed.")]),e._v(" "),e._m(4),e._v(" "),e._m(5),e._v(" "),i("p",[e._v("It is possible to enable CSF when Imunify360 is already running. All IP addresses from Imunify360 White List will be exported to CSF ignore list. In about 30 seconds after CSF started, Imunify360 switches to CSF Integration mode.")]),e._v(" "),e._m(6),e._v(" "),e._m(7),e._v(" "),e._m(8),e._v(" "),e._m(9),e._v(" "),e._m(10),e._v(" "),i("p",[e._v("In this case, Imunify360 will block IPs only by mod_security events with high severity.")]),e._v(" "),e._m(11),e._v(" "),i("p",[i("a",{attrs:{href:"https://configserver.com/cp/cxs.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("ConfigServer eXploit Scanner"),i("OutboundLink")],1),e._v(" (CXS) has different types of malware scanning, which affects Imunify360 Malware Scanner functionality. Below we describe how to make Imunify360 Malware Scanner work properly. These functionalities can be configured at "),i("router-link",{attrs:{to:"/dashboard/#settings"}},[e._v("Malware Scanner settings")]),e._v(" page, but CXS itself must be configured  as follows:")],1),e._v(" "),i("ol",[e._m(12),e._v(" "),e._m(13),e._v(" "),i("li",[e._m(14),e._v(" "),i("p",[e._v("Imunify360 supports only "),i("a",{attrs:{href:"https://www.pureftpd.org",target:"_blank",rel:"noopener noreferrer"}},[e._v("Pure-FTPd"),i("OutboundLink")],1),e._v(". For Pure-FTPd CXS launches pure-uploadscript for the scan. Any pure-uploadscript used by CXS must be disabled.")])]),e._v(" "),e._m(15)]),e._v(" "),e._m(16),e._v(" "),e._m(17),e._v(" "),e._m(18),e._v(" "),i("p",[e._v("This is implemented by using Imunify360 WebShield reverse proxy. All traffic from Cloudflare IP addresses is redirected to the WebShield using iptables rules.\nWebShield detects real visitor's IP address using CF-Connecting-IP and X-Forwarded-For headers, then forwards request to the backend for the valid IP addresses and shows captcha to graylisted IP addresses.")]),e._v(" "),e._m(19),e._v(" "),e._m(20)])},[function(){var e=this.$createElement,t=this._self._c||e;return t("h1",{attrs:{id:"ids-integrations"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ids-integrations","aria-hidden":"true"}},[this._v("#")]),this._v(" IDS Integrations")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"csf-integration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#csf-integration","aria-hidden":"true"}},[this._v("#")]),this._v(" CSF Integration")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("If CSF is "),t("strong",[this._v("disabled")]),this._v(" then Imunify360 becomes a primary IDS.")])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("ul",[i("li",[e._v("White List is loaded from CSF. Imunify360 and CSF work without any additional actions.")]),e._v(" "),i("li",[e._v("Gray List is not imported from CSF but it is possible to view and manage Gray List in Imunify360 interface. All changes "),i("strong",[e._v("will not")]),e._v(" be automatically exported to CSF.")]),e._v(" "),i("li",[e._v("Black List is not imported from CSF but it is possible to view and manage Black List in Imunify360 interface. All changes "),i("strong",[e._v("will not")]),e._v(" be automatically exported to CSF.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("ul",[t("li",[this._v("Black List, Gray List, and White List can be managed in Imunify360 regardless of CSF.")]),this._v(" "),t("li",[this._v("CSF Allow, Deny and Ignore Lists are not automatically imported from CSF. They can still be managed using CSF interface.")]),this._v(" "),t("li",[this._v("Imunify360 will not block addresses from CSF Allow and Ignore Lists.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("img",{attrs:{src:"/images/firewallblacklistwarning_zoom70.png",alt:""}})])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v('To check if CSF integration is enabled go to Imunify360 → Firewall tab → White List section and check if there is a warning message "'),t("em",[this._v("CSF is enabled. Please manage IPs whitelisted in CSF using CSF user interface or config file")]),this._v('". It means that CSF and Imunify360 integration processed successfully.')])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("To get events from Login Failure Daemon (LFD), Imunify360 automatically replaces BLOCK_REPORT variable to the file path of Imunify360 script.\nIn CSF integration mode, when some IP address is blocked by LFD, Imunify360 adds this IP address to its Graylist and then "),t("strong",[this._v("removes it from CSF’s deny/tempdeny lists")]),this._v(". The latter is done to allow IP to have access to the Captcha and to store all automatically blocked IP addresses in a single place. Thus, no IP automatically added to CSF deny/tempdeny lists.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[this._v("Mod_security recommendations")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("When mod_security is configured with SecRuleEngine On (blocking mode), CSF blocks IP addresses by mod_security events. The number of events to block IP address is defined by "),t("code",[this._v("LF_MODSEC")]),this._v(" variable in "),t("code",[this._v("csf.conf")]),this._v(". This can lead to a large number of false positives.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("We recommend to set "),t("code",[this._v("LF_MODSEC")]),this._v(" variable to 0.")])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"cxs-integration"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cxs-integration","aria-hidden":"true"}},[this._v("#")]),this._v(" CXS Integration")])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("p",[t("em",[this._v("Automatically scan all modified files")])]),this._v(" "),t("p",[this._v("CXS Watch daemon must be disabled.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("p",[t("em",[this._v("Automatically scan any files uploaded using web")])]),this._v(" "),t("p",[this._v("CXS ModSecurity vendor should be disabled.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("em",[this._v("Automatically scan any file uploaded using ftp")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("li",[t("p",[t("em",[this._v("On-Demand scanning")])]),this._v(" "),t("p",[this._v("This type of scanning can be always run by Imunify360 and CXS separately. No special actions required.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"tip custom-block"},[t("p",{staticClass:"custom-block-title"},[this._v("Note")]),this._v(" "),t("p",[this._v("Imunify360 doesn’t make any imports from CXS.")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("h2",{attrs:{id:"cloudflare-support-3-8"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cloudflare-support-3-8","aria-hidden":"true"}},[this._v("#")]),this._v(" Cloudflare support "),t("sup",[this._v("3.8+")])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[t("strong",[t("em",[this._v("Starting from version 3.8, Imunify360 supports graylisting IP addresses behind Cloudflare.")])])])},function(){var e=this.$createElement,t=this._self._c||e;return t("p",[this._v("Cloudflare support is disabled by default. To enable it, add the following section to the Imunify360 config file ("),t("em",[this._v("/etc/sysconfig/imunify360/imunify360.config")]),this._v("):")])},function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[this._v("WEBSHIELD:\n  known_proxies_support: true\n")])])])}],!1,null,null,null);n.options.__file="README.md";t.default=n.exports}}]);