<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Command-line Interface | Documentation</title>
    <meta name="description" content="Kernelcare documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.5ccae1ef.css" as="style"><link rel="preload" href="/assets/js/app.82cee872.js" as="script"><link rel="preload" href="/assets/js/8.6619a899.js" as="script"><link rel="prefetch" href="/assets/js/10.b51fe28b.js"><link rel="prefetch" href="/assets/js/11.e6dc8b34.js"><link rel="prefetch" href="/assets/js/12.4bcb335d.js"><link rel="prefetch" href="/assets/js/13.d0200ffb.js"><link rel="prefetch" href="/assets/js/14.555a9df0.js"><link rel="prefetch" href="/assets/js/15.e307524e.js"><link rel="prefetch" href="/assets/js/16.1cca512c.js"><link rel="prefetch" href="/assets/js/17.a68b8f5e.js"><link rel="prefetch" href="/assets/js/18.3419b333.js"><link rel="prefetch" href="/assets/js/19.233ab1aa.js"><link rel="prefetch" href="/assets/js/20.2c54de63.js"><link rel="prefetch" href="/assets/js/3.4eb84044.js"><link rel="prefetch" href="/assets/js/4.b81ccb47.js"><link rel="prefetch" href="/assets/js/5.3d4a6f6f.js"><link rel="prefetch" href="/assets/js/6.3a9c5751.js"><link rel="prefetch" href="/assets/js/7.b3aaff77.js"><link rel="prefetch" href="/assets/js/9.48f2c7f5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.28e1d2e5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5ccae1ef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="Search"> <!----></div> <div class="links" style="max-width:nullpx;"><a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Content</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/terminology/" class="sidebar-link">Terminology</a></li><li><a href="/billing/" class="sidebar-link">Billing</a></li><li><a href="/installation/" class="sidebar-link">Installation Guide</a></li><li><a href="/ids_integration/" class="sidebar-link">IDS Integrations</a></li><li><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></li><li><a href="/localization/" class="sidebar-link">Localization</a></li><li><a href="/captcha/" class="sidebar-link">Captcha</a></li><li><a href="/dashboard/" class="sidebar-link">Imunify360 User Interface</a></li><li><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulsets Specific Settings</a></li><li><a href="/config_file_description/" class="sidebar-link">Config File Description</a></li><li><a href="/command_line_interface/" class="active sidebar-link">Command-line Interface</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/command_line_interface/#_3rdparty" class="sidebar-link">3rdparty</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#blacklist" class="sidebar-link">Blacklist</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#blocked-ports" class="sidebar-link">Blocked ports</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#check-domains" class="sidebar-link">Check-domains</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#clean" class="sidebar-link">Clean</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#checkdb" class="sidebar-link">Checkdb</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#doctor" class="sidebar-link">Doctor</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#features" class="sidebar-link">Features</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#get" class="sidebar-link">Get</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#graylist" class="sidebar-link">Graylist</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#import" class="sidebar-link">Import</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#infected-domains" class="sidebar-link">Infected-domains</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#malware" class="sidebar-link">Malware</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#migratedb" class="sidebar-link">Migratedb</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#plugins" class="sidebar-link">Plugins</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#register" class="sidebar-link">Register</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#rstatus" class="sidebar-link">Rstatus</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#rules" class="sidebar-link">Rules</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#unregister" class="sidebar-link">Unregister</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#vendors" class="sidebar-link">Vendors</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#version" class="sidebar-link">Version</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#submit-false-positive-or-false-negative-to-imunify360-team-for-analysis" class="sidebar-link">Submit false positive or false negative to Imunify360 team for analysis</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#whitelist" class="sidebar-link">Whitelist</a></li><li class="sidebar-sub-header"><a href="/command_line_interface/#proactive" class="sidebar-link">Proactive</a></li></ul></li><li><a href="/uninstall/" class="sidebar-link">Uninstall</a></li><li><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></li><li><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="command-line-interface"><a href="#command-line-interface" aria-hidden="true" class="header-anchor">#</a> Command-line Interface</h1> <p>For access to Imunify360 agent features from command-line interface, use the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Returns the help message</td></tr> <tr><td><code>--console-log-level [ERROR,WARNING,INFO,DEBUG]</code></td> <td>Level of logging input to the console</td></tr></tbody></table> <p>Basic usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent [command] [--option1] [--option2]...
</code></pre></div><p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>3rdparty</code></td> <td>Make Imunify360 the primary IDS</td></tr> <tr><td><code>blacklist</code></td> <td>Return/Edit IP blacklist</td></tr> <tr><td><code>blocked-port</code></td> <td>Return/Edit list of blocked ports</td></tr> <tr><td><code>check-domains</code></td> <td>Send domain list check</td></tr> <tr><td><code>clean</code></td> <td>Clean the incidents</td></tr> <tr><td><code>checkdb</code></td> <td>Check database integrity</td></tr> <tr><td><code>doctor</code></td> <td>Collect info about system and send it to CloudLinux</td></tr> <tr><td><code>features</code></td> <td>Manage available features for Imunify360</td></tr> <tr><td><code>get</code></td> <td>Returns list of incidents</td></tr> <tr><td><code>graylist</code></td> <td>Return/Edit IP Gray List</td></tr> <tr><td><code>import</code></td> <td>Import data</td></tr> <tr><td><code>infected-domains</code></td> <td>Returns infected domain list</td></tr> <tr><td><code>malware</code></td> <td>Allows to manage malware options</td></tr> <tr><td><code>migratedb</code></td> <td>Check and repair database if it is corrupted</td></tr> <tr><td><code>plugins</code></td> <td>Command for manipulating Imunify360 plugin</td></tr> <tr><td><code>register</code></td> <td>Agent registration</td></tr> <tr><td><code>rstatus</code></td> <td>Query the server to check if the license is valid</td></tr> <tr><td><code>rules</code></td> <td>Allows user to manage disabled rules</td></tr> <tr><td><code>unregister</code></td> <td>Unregistration the agent</td></tr> <tr><td><code>vendors</code></td> <td>Command for manipulating Imunify360 vendors</td></tr> <tr><td><code>version</code></td> <td>Show version</td></tr> <tr><td><code>whitelist</code></td> <td>Return/Edit operator for IP and domain white list</td></tr> <tr><td><code>proactive</code><sup>3.7.0+</sup></td> <td>Allows to manage Proactive Defense feature</td></tr></tbody></table> <p>Optional arguments for the commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Shows this help message.</td></tr> <tr><td><code>--json</code></td> <td>Returns data in JSON format.</td></tr> <tr><td><code>--by-country-code [country_code]</code></td> <td>Filters output by country code.<br>Requires valid country code as argument.<br> Find valid country codes <a href="https://www.nationsonline.org/oneworld/country_code_list.htm" target="_blank" rel="noopener noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in column ISO ALPHA-2 CODE.</td></tr> <tr><td><code>--by-ip [ip_address]</code></td> <td>Filters output by abuser's IP or by subnet in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.<br>Example: <code>--by-ip 1.2.3.0/24</code>.</td></tr> <tr><td><code>--by-list</code></td> <td>Can be:<br><ul><li>any</li><li>gray (Gray List)</li><li>white (White List)</li><li>black (Black List)</li></ul>Filters output based on the list type.<br>Example: <code>--by-list black</code>.</td></tr> <tr><td><code>--limit</code></td> <td>limits the output with specified number of incidents.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><code>--offset</code></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><code>--to</code></td> <td>Allows to set the end of the period for filter.<br>Format is a timestamp.</td></tr> <tr><td><code>--manual-only</code></td> <td>Show only IP’s that have been added manually.</td></tr> <tr><td><code>--no-manual-only</code></td> <td>Show IP’s that have been added both automatically<br>and manually.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if<br>option <code>--json</code> is used.</td></tr></tbody></table> <h2 id="_3rdparty"><a href="#_3rdparty" aria-hidden="true" class="header-anchor">#</a> 3rdparty</h2> <p>Command for disabling 3rd party IDS (currently they are cPHulk and fail2ban) and make Imunify360 agent the primary IDS.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent 3rdparty [-h]
</code></pre></div><p><code>command</code> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>conflicts</code></td> <td>Show conflicts with other software</td></tr> <tr><td><code>list</code></td> <td>List other IDS that might be running concurrently with Imunify360</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message</td></tr></tbody></table> <p></p> <h2 id="blacklist"><a href="#blacklist" aria-hidden="true" class="header-anchor">#</a> Blacklist</h2> <p>This command allows to view or edit actual IPs in the blacklist.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blacklist [subject] [command] &lt;value&gt; [--option]
</code></pre></div><p><code>subject</code> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>country</code></td> <td>Allows to manipulate with countries in the Black List</td></tr> <tr><td><code>ip</code></td> <td>Allows to manipulate with IPs in the Black List</td></tr></tbody></table> <p><code>command</code> is a second positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>add</code></td> <td>add item(-s) to Black List</td></tr> <tr><td><code>delete</code></td> <td>remove item(-s) from Black List</td></tr> <tr><td><code>move</code></td> <td>move item(-s) to Black List</td></tr> <tr><td><code>edit</code></td> <td>edit comment on item in the Black List</td></tr> <tr><td><code>list</code></td> <td>list items(-s) in Black List</td></tr></tbody></table> <p>Please note that by default <code>list</code> command outputs only first 100 items in the list as if it was run as <code>blacklist ip list --limit 100</code> .
To check whether specific IP address is in the list, you can run the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>blacklist ip list --by-ip 12.34.56.78
</code></pre></div><p>where 12.34.56.78 is that specific IP address.</p> <p><code>value</code> is an item to manipulate with. It can be IP itself or a country code (find necessary country codes here in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the column ISO ALPHA-2 CODE).</p> <p><code>option</code> can be one or few of the optional arguments specified above and one more:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--comment</code></td> <td>allows to add comment to the item</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ul><li><p>The following command adds IP 1.2.3.4 to the Black List with a comment “one bad IP”:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blacklist ip add 1.2.3.4 --comment “one bad ip”
</code></pre></div></li> <li><p>The following command returns a list of IPs in the Black List which are from Bolivia:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blacklist --by-country-code BO
</code></pre></div></li></ul> <p></p> <h2 id="blocked-ports"><a href="#blocked-ports" aria-hidden="true" class="header-anchor">#</a> Blocked ports</h2> <p>This command allows to view or edit ports, IPs, and protocols in the list of blocked ports.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blocked-port [command] &lt;value&gt; [--option]
</code></pre></div><p><code>command</code> is a first positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>add</code></td> <td>add item(-s) to blocked ports</td></tr> <tr><td><code>delete</code></td> <td>remove item(-s) from blocked ports</td></tr> <tr><td><code>edit</code></td> <td>edit comment on item in the blocked ports</td></tr> <tr><td><code>list</code></td> <td>list items(-s) in blocked ports</td></tr></tbody></table> <p><code>value</code> is an item to manipulate with. <code>value</code> is <code>:</code> separated pair of port number and protocol: <code>5432:tcp</code>, <code>28:udp</code></p> <p><code>option</code> can be one or few of the optional arguments specified above and some more:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--comment</code></td> <td>allows to add comment to the item</td></tr> <tr><td><code>--ips</code></td> <td>allows to add IP addresses to ignore list of the<br>blocked port (port won’t be blocked for this IP addresses)</td></tr></tbody></table> <p><strong>Example:</strong></p> <p>The following command blocks port 5555 for tcp connections with a comment “Some comment”:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent blocked-port add 5555:tcp --comment “Some comment”
</code></pre></div><p></p> <h2 id="check-domains"><a href="#check-domains" aria-hidden="true" class="header-anchor">#</a> Check-domains</h2> <p>Allows to send domains list to check on Imunify360 central server. This command requires cPanel. After domains checked, the results is available via command <code>infected-domains</code>.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>The server requires some time for checking and the results may not be ready immediately.</p></div> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent check-domains [--optional arguments]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>show this help message</td></tr> <tr><td><code>--json</code></td> <td>return data in JSON format</td></tr> <tr><td><code>--verbose, -v</code></td> <td>allows to return data in good-looking view if option <code>--json</code> is used</td></tr></tbody></table> <h2 id="clean"><a href="#clean" aria-hidden="true" class="header-anchor">#</a> Clean</h2> <p>Clean the incident list.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent clean [--optional arguments]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>show this help message</td></tr> <tr><td><code>--json</code></td> <td>return data in JSON format</td></tr> <tr><td><code>--days</code></td> <td>cleanups incidents from database, if there are more than specified days quantity<br>Example: <code>--days 5</code>.<br>this option will cause deletion of all incidents that are older than 5 days from today</td></tr> <tr><td><code>--limi|</code></td> <td>leaves only limited number of the incidents in the database and deletes the others<br>Example: <code>--limit 5000</code>.<br>this option will leave only 5000 new incidents and delete the others</td></tr></tbody></table> <h2 id="checkdb"><a href="#checkdb" aria-hidden="true" class="header-anchor">#</a> Checkdb</h2> <p>Checks database integrity. In case database is corrupt, then this command saves backup copy of the database at <code>/var/imunify360</code> and tries to restore integrity of the original database. Note that if this command cannot restore database integrity, then it will destroy the original broken database. Use <code>migratedb</code> command to create new clean database.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent checkdb [-h]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <h2 id="doctor"><a href="#doctor" aria-hidden="true" class="header-anchor">#</a> Doctor</h2> <p>Collecting information about Imunify360 state, generating the report and sending it to Imunify360 Support Team. This command can be used in case of any troubles or issues with Imunify360. This command will generate a key to be sent to Imunify360 Support Team. With that key Imunify360 Support Team can help with any problem as fast as possible.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent doctor [-h]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <p></p> <h2 id="features"><a href="#features" aria-hidden="true" class="header-anchor">#</a> Features</h2> <p>Allows to enable or disable additional CloudLinux software included in Imunify360 for free. The following software is available:</p> <ul><li><a href="https://www.kernelcare.com" target="_blank" rel="noopener noreferrer">KernelCare<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://www.cloudlinux.com/hardenedphp" target="_blank" rel="noopener noreferrer">HardenedPHP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>Invisible Captcha</li></ul> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features [-h] [command] &lt;feature name&gt;
</code></pre></div><p><code>command</code> is a positional arguments and can be :</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>install</code></td> <td>allows to enable software</td></tr> <tr><td><code>remove</code></td> <td>allows to disable software</td></tr> <tr><td><code>status</code></td> <td>allows to check the status of the software</td></tr> <tr><td><code>list</code></td> <td>allows to list all available software</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>show this help message</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ol><li><p>The following command checks if KernelCare is installed:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features status kernelcare
</code></pre></div></li> <li><p>The following command installs KernelCare:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features install kernelcare
</code></pre></div></li> <li><p>The following command uninstalls KernelCare:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent features remove kernelcare
</code></pre></div></li></ol> <h2 id="get"><a href="#get" aria-hidden="true" class="header-anchor">#</a> Get</h2> <p>The command returns the lists of incidents.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent get [--required argument] [--optional argument]...
</code></pre></div><p>Option can be one or few of the optional arguments listed above and one more.</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--period [period]</code></td> <td>Timeframe.<br>Allows to specify the amount of time starting from the current day.<br>Should be greater than (or equal to) 1 minute.<br>Can be specified in format:<ul><li><code>&lt;int&gt;m</code> – minutes, example <code>--period 30m</code></li><li><code>&lt;int&gt;h</code> – hours, example <code>--period 4h</code></li><li><code>&lt;int&gt;d</code> – days, example <code>--period 7d</code></li><li><code>today</code> – for today, example <code>--period today</code></li><li><code>yesterday</code> – for yesterday, example <code>--period yesterday</code></li></ul>For example, <code>--period 5d</code> will return a list of incidents for 5 days.</td></tr> <tr><td><code>--since [timestamp]</code></td> <td>allows to set start time to filter the list of incidents by period</td></tr> <tr><td><code>--to [timestamp]</code></td> <td>allows to set finish time to filter the list of incidents by period</td></tr> <tr><td><code>--severity</code></td> <td>allows to set severity to filter the list of incidents</td></tr></tbody></table> <p><em>Example:</em></p> <p>The following command shows the incidents (in JSON format) for recent one hour, filtered by country code UA and filtered by Black List IPs:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent get --period 1h --by-country-code UA --by-list black --json
</code></pre></div><h2 id="graylist"><a href="#graylist" aria-hidden="true" class="header-anchor">#</a> Graylist</h2> <p>This command allows to view or edit actual IP blacklist.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent graylist ip [command] [--optional argument]
</code></pre></div><p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>delete</code></td> <td>allows to remove IP from Gray List</td></tr> <tr><td><code>list</code></td> <td>allows to list IPs in Gray List</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>show this help message</td></tr></tbody></table> <p>Optional arguments for <code>list</code> :</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--json</code></td> <td>Returns data in JSON format.</td></tr> <tr><td><code>--by-country-code [country_code]</code></td> <td>Filters output by country code.<br>Requires valid country code as argument.<br>Find valid country codes<br>in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in column ISO ALPHA-2 CODE.</td></tr> <tr><td><code>--by-ip [ip_address]</code></td> <td>Filters output by abuser's IP or by subnet in CIDR notation.<br>Example: <code>--by-ip 1.2.3.0/24</code></td></tr> <tr><td><code>--limit</code></td> <td>Limits the output with specified number of IPs.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><code>--offset</code></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view<br>if option <code>--json</code> is used.</td></tr></tbody></table> <p>Please note that by default <code>list</code> command outputs only first 100 items in the list as if it was run as <code>graylist ip list --limit 100</code>.
To check whether specific IP address is in the list, you can run the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>graylist ip list --by-ip 12.34.56.78
</code></pre></div><p>where <code>12.34.56.78</code> is that specific IP address.</p> <p><strong>Example:</strong></p> <p>The following command will remove IP <code>1.2.3.4</code> from the Gray List:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent graylist ip delete 1.2.3.4
</code></pre></div><h2 id="import"><a href="#import" aria-hidden="true" class="header-anchor">#</a> Import</h2> <p>This command allows to import Black and White lists from the other 3rd party IDS (only CSF supported at the moment) to Imunify360 database.
Note. If CSF is enabled, then it is not necessary to run the command because Imunify360 is integrated with CSF.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent import [-h] {blocked-ports, wblist} ...
</code></pre></div><p>Positional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>blocked-ports</code></td> <td>Import blocked-ports from other IDS</td></tr> <tr><td><code>wblist</code></td> <td>Import White/Black List from other IDS</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message</td></tr></tbody></table> <p><strong>Example:</strong></p> <p>The following command will import Black and White Lists from the 3rd party IDS:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent import wblist
</code></pre></div><h2 id="infected-domains"><a href="#infected-domains" aria-hidden="true" class="header-anchor">#</a> Infected-domains</h2> <p>Allows to retrieve infected domains list.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent infected-domains [-h] [--optional arguments]
</code></pre></div><p>Optional arguments for <code>list</code>:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--json</code></td> <td>Returns data in JSON format.</td></tr> <tr><td><code>--limit</code></td> <td>Limits the output with the specified number of domains.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><code>--offset</code></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in a good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <p></p> <h2 id="malware"><a href="#malware" aria-hidden="true" class="header-anchor">#</a> Malware</h2> <p>Allows to manage malware options.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent malware [-h] [--optional arguments]
</code></pre></div><p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>dashboard indicators</code></td> <td>Show indicators for dashboard.</td></tr> <tr><td><code>ignore</code></td> <td>Allows to add, delete or show files which will not be scanned.</td></tr> <tr><td><code>malicious</code></td> <td>Allows to manage malicious files.</td></tr> <tr><td><code>on-demand</code></td> <td>Allows to manage on-demand scanner.</td></tr> <tr><td><code>read</code></td> <td>Allows to read malware files.</td></tr> <tr><td><code>suspicious</code></td> <td>Allows to manage suspicious files.</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Returns data in JSON format.</td></tr> <tr><td><code>--limit</code></td> <td>Limits the output with the specified number of domains.<br>Must be a number greater than zero. By default, equals 100.</td></tr> <tr><td><code>--offset</code></td> <td>Offset for pagination. By default, equals 0.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in a good-looking view if option <code>--json</code> is used.</td></tr> <tr><td><code>--since SINCE</code></td> <td>Start date.</td></tr> <tr><td><code>--to TO</code></td> <td>End date.</td></tr> <tr><td><code>--user USER</code></td> <td>Returns results for a chosen user.</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>ignore</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>add</code></td> <td>Add a file or files divided by space to the ignore list.</td></tr> <tr><td><code>delete</code></td> <td>Delete an ignored file or files divided by space from the list.</td></tr> <tr><td><code>list</code></td> <td>Show a list of ignored files.</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>malicious</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>delete</code></td> <td>Delete malicious file or files divided by space.</td></tr> <tr><td><code>list</code></td> <td>Show a list of malicious files.</td></tr> <tr><td><code>move-to-ignore</code></td> <td>Move a file or files divided by space to the ignore list.</td></tr> <tr><td><code>quarantine-malicious</code></td> <td>Allows to add malicious files to quarantine.</td></tr> <tr><td><code>restore-from-backup</code></td> <td>Restore source files from backup.</td></tr> <tr><td><code>restore-from-quarantine</code></td> <td>Restore files from quarantine.</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>on-demand</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>start</code></td> <td>Start on-demand scanner for the path specified after the <code>start</code> command.<br>For example: <code>imunify360-agent malware on-demand start --path /home/&lt;username&gt;/public_html/</code></td></tr> <tr><td><code>list</code></td> <td>Returns a list of all on-demand scanner session results.</td></tr> <tr><td><code>status</code></td> <td>Show current status for on-demand scanner.</td></tr> <tr><td><code>stop</code></td> <td>Stop current scanning.</td></tr></tbody></table> <p><code>command</code> is a second positional argument for <code>suspicious</code> and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>delete</code></td> <td>Delete suspicious file or files divided by space.</td></tr> <tr><td><code>list</code></td> <td>Show a list of suspicious files.</td></tr> <tr><td><code>move-to-ignore</code></td> <td>Move suspicious files divided by space to the ignore list.</td></tr> <tr><td><code>move-to-quarantine</code></td> <td>Move suspicious files divided by space to the quarantine</td></tr></tbody></table> <p></p> <h2 id="migratedb"><a href="#migratedb" aria-hidden="true" class="header-anchor">#</a> Migratedb</h2> <p>Allows to create clean database if it was corrupted.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Use <code>checkdb</code> to check database health.</p></div> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>Imunify360-agent migratedb [-h]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--help, -h</code></td> <td>show this help message</td></tr></tbody></table> <h2 id="plugins"><a href="#plugins" aria-hidden="true" class="header-anchor">#</a> Plugins</h2> <p>Command for manipulating Imunify360 plugins.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent [command]
</code></pre></div><p><code>command</code> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>enable-plugin</code></td> <td>Enable Imunify360 plugin.</td></tr> <tr><td><code>disable-plugin</code></td> <td>Disable Imunify360 plugin.</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <p></p> <h2 id="register"><a href="#register" aria-hidden="true" class="header-anchor">#</a> Register</h2> <p>Allows to register and activate Imunify360. You can use it in case if Imunify360 was not activated during installation process or in case if activation key of the Imunify360 was changed for any reason. If you do not know what is an activation key or have any problem with it then, please, read <a href="/installation/">Installation guide</a> or contact our <a href="https://cloudlinux.zendesk.com/hc/requests/new" target="_blank" rel="noopener noreferrer">support team<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent register [--optional arguments] [KEY]
</code></pre></div><p><code>KEY</code> is a positional argument:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>KEY</code></td> <td>Register with activation key (use <code>IPL</code> to register by IP).</td></tr></tbody></table> <p>If you will use this command without the <code>KEY</code> argument, then it will try to register and activate current activation key.</p> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <p><strong>Example 1:</strong></p> <p>The following command will register and activate Imunify360 with the provided activation key:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent register IM250sdfkKK245kJHIL
</code></pre></div><p><strong>Example 2:</strong></p> <p>If you have an IP-based license, you can use <code>IPL</code> argument to register and activate Imunify360:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent register IPL
</code></pre></div><h2 id="rstatus"><a href="#rstatus" aria-hidden="true" class="header-anchor">#</a> Rstatus</h2> <p>Allows to check if Imunify360 server license is valid.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rstatus [--optional arguments]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>-json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <h2 id="rules"><a href="#rules" aria-hidden="true" class="header-anchor">#</a> Rules</h2> <p>This command allows user to manage rules disabled for firewall plugins Imunify360 uses.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules [command] [--option] &lt;value&gt; [--option] &lt;value&gt;
</code></pre></div><p><code>command</code> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>disable</code></td> <td>Add a new rule to the disabled rules list.</td></tr> <tr><td><code>enable</code></td> <td>Remove a rule from the disabled rules list.</td></tr> <tr><td><code>list-disabled</code></td> <td>Display the list of the disabled rules.</td></tr></tbody></table> <p>Option can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--id</code></td> <td>ID number of the rule provided by the firewall plugin.</td></tr> <tr><td><code>--plugin</code></td> <td>Firewall plugin name. Can be one of the following:<ul><li><code>modsec</code> for ModSecurity</li><li><code>ossec</code> for OSSEC</li></ul></td></tr> <tr><td><code>--name</code></td> <td>Name of the added rule or details of the rule from ModSecurity or OSSEC.</td></tr></tbody></table> <p><strong>Examples</strong></p> <ol><li><p>The following command adds a rule with id 42 and name ‘Rule name’ for the ModSecurity rules to the disabled rules list:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules disable --id 42 --plugin modsec --name 'Rule name'
</code></pre></div></li> <li><p>The following command removes a rule with id 42 for the ModSecurity rules from the disabled rules list:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules enable --id 42 --plugin modsec
</code></pre></div></li> <li><p>The following command displays the list of disabled rules:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent rules list-disabled
</code></pre></div><p>The list is displayed as follows:</p> <div class="language-Python extra-class"><pre class="language-python"><code><span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'modsec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'214920'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'captchatest.com'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Imported from config'</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'modsec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'42'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Rule name'</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'ossec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'1003'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'Imported from config'</span><span class="token punctuation">}</span>

<span class="token punctuation">{</span><span class="token string">'plugin'</span><span class="token punctuation">:</span> <span class="token string">'ossec'</span><span class="token punctuation">,</span> <span class="token string">'id'</span><span class="token punctuation">:</span> <span class="token string">'2502'</span><span class="token punctuation">,</span> <span class="token string">'domains'</span><span class="token punctuation">:</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token string">'User missed the password more than one time'</span><span class="token punctuation">}</span>
</code></pre></div><p>Where</p> <ul><li>plugin — is a firewall plugin name (modsec for ModSecurity and ossec for OSSEC)</li> <li>id — is id number of the rule provided by the firewall plugin</li> <li>domains — the list of the domains for which the rule is disabled (None means all domains)*</li> <li>name — rule description or details of the rule from ModSecurity or OSSEC</li></ul> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Domains are specified only for ModSecurity rules. For OSSEC rules it is always applies to all domains.</p></div></li></ol> <p></p> <h2 id="unregister"><a href="#unregister" aria-hidden="true" class="header-anchor">#</a> Unregister</h2> <p>Allows to unregister and disable Imunify360 on the server.</p> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>To remove Imunify360 from the server it needs to be <a href="/uninstall/">uninstalled</a>.</p></div> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent unregister [--optional arguments]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <h2 id="vendors"><a href="#vendors" aria-hidden="true" class="header-anchor">#</a> Vendors</h2> <p>Command for manipulating Imunify360 vendors.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent [command]
</code></pre></div><p><code>command</code> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>install-vendors</code></td> <td>Install ModSecurity vendors.<br>This command will install Imunify360 vendor and<br><a href="https://modsecurity.comodo.com/" target="_blank" rel="noopener noreferrer">Comodo WAF<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> if there are no conflicts with other installed vendors.</td></tr> <tr><td><code>uninstall-vendors</code></td> <td>uninstall ModSecurity vendors.</td></tr></tbody></table> <p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <h2 id="version"><a href="#version" aria-hidden="true" class="header-anchor">#</a> Version</h2> <p>Allows to view the actual Imunify360 version installed on the server.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent version [-h] [--json]
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>-h, --help</code></td> <td>Show this help message.</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <h2 id="submit-false-positive-or-false-negative-to-imunify360-team-for-analysis"><a href="#submit-false-positive-or-false-negative-to-imunify360-team-for-analysis" aria-hidden="true" class="header-anchor">#</a> Submit false positive or false negative to Imunify360 team for analysis</h2> <p>To submit file as false positive (if Imunify360 considers file as a malicious but it actually doesn’t) you can use the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent submit false-positive &lt;file&gt;
</code></pre></div><p>To submit file as false negative (if Imunify360 considers file as a non-malicious but it actually does) you can use the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent submit false-negative &lt;file&gt;
</code></pre></div><p>Optional arguments:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--to</code></td> <td>Email to send.</td></tr> <tr><td><code>--sender</code></td> <td>User email.</td></tr> <tr><td><code>-h, --help</code></td> <td>Show this help message</td></tr> <tr><td><code>--json</code></td> <td>Return data in JSON format.</td></tr> <tr><td><code>--verbose, -v</code></td> <td>Allows to return data in good-looking view if option <code>--json</code> is used.</td></tr></tbody></table> <p></p> <h2 id="whitelist"><a href="#whitelist" aria-hidden="true" class="header-anchor">#</a> Whitelist</h2> <p>This command allows to view or edit actual IPs and domains in the Whitelist.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist [subject] [command] &lt;value&gt; [--option]
</code></pre></div><p><code>subject</code> is a positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>ip</code></td> <td>Allows to manipulate with IPs in the White List.</td></tr> <tr><td><code>domain</code></td> <td>Allows to manipulate with domains in the White List.</td></tr></tbody></table> <p><code>command</code> is a second positional argument and can be:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>add</code></td> <td>Add item(-s) to the White List.</td></tr> <tr><td><code>delete</code></td> <td>Remove item(-s) from the White List.</td></tr> <tr><td><code>move</code></td> <td>Move item(-s) to the White List.</td></tr> <tr><td><code>edit</code></td> <td>Edit comment on the item in the White List.</td></tr> <tr><td><code>list</code></td> <td>List items(-s) in the White List.</td></tr></tbody></table> <p>Please note that by default <code>list</code> command outputs only first 100 items in the list as if it was run as <code>whitelist ip list --limit 100</code>.
To check whether specific IP address is in the list, you can run the following command:</p> <div class="language- extra-class"><pre class="language-text"><code>whitelist ip list --by-ip 12.34.56.78
</code></pre></div><p>where <code>12.34.56.78</code> is that specific IP address.</p> <p><code>value</code> is an item to manipulate with. It can be IP itself or a country code (find the necessary country codes in <a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#IPv4_CIDR_blocks" target="_blank" rel="noopener noreferrer">CIDR notation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in ISO ALPHA-2 CODE column), or a domain name.</p> <p><code>option</code> can be one or few of the optional arguments from the table above and one more:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--comment</code></td> <td>Allows to add a comment to the item.</td></tr> <tr><td><code>--full-access</code></td> <td>Only for <code>move</code> and <code>edit</code> commands.<br>Allows to grant full access to the IP or subnet ignoring the rules in Blocked ports.</td></tr> <tr><td><code>--no-full-access</code></td> <td>Only for <code>move</code> and <code>edit</code> commands.<br>Allows to remove full access of the IP or subnet.</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ol><li><p>The following commands adds IP <code>1.2.3.4</code> to the White List with a comment “one bad ip”:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist ip add 1.2.3.4 --comment “one good ip”
</code></pre></div></li> <li><p>The following command returns a list of IPs in the White List which are from Bolivia:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist --by-country-code BO
</code></pre></div></li> <li><p>The following command adds domain with a name <code>example.com</code> to the White List:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist domain add example.com
</code></pre></div></li> <li><p>The following command checks domains in the White List:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent whitelist domain list
</code></pre></div></li></ol> <h2 id="proactive"><a href="#proactive" aria-hidden="true" class="header-anchor">#</a> Proactive</h2> <p>These commands allow to manage Proactive Defense feature.</p> <p>Usage:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent proactive [command] [--option] &lt;value&gt;
</code></pre></div><p>Available commands:</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>ignore delete path</code></td> <td>allows to remove a file from Proactive Defense Ignore List.</td></tr> <tr><td><code>ignore delete rule</code></td> <td>allows to remove a rule for a file from Proactive Defense Ignore List.</td></tr> <tr><td><code>list</code></td> <td>allows to list Proactive Defense events.</td></tr> <tr><td><code>details</code></td> <td>allows to show details for the event.</td></tr> <tr><td><code>ignore list</code></td> <td>allows to list files included to Proactive Defense Ignore List.</td></tr> <tr><td><code>ignore add</code></td> <td>allows to add a file to Proactive Defense Ignore List.</td></tr></tbody></table> <p><code>option</code> can be one or few of the optional arguments listed above and one more.</p> <table><thead><tr><th></th> <th></th></tr></thead> <tbody><tr><td><code>--path</code></td> <td>for <code>ignore add</code>, <code>ignore delete path</code>, <code>ignore delete rule</code> commands.<br>Allows to specify a path to the file.</td></tr> <tr><td><code>--id</code></td> <td>for <code>details</code>, <code>ignore delete rule</code> commands.<br>Allows to specify rule id.</td></tr> <tr><td><code>--rule-id</code></td> <td>only for <code>ignore add</code> command.<br>Allows to specify rule id.</td></tr> <tr><td><code>--rule-name</code></td> <td>only for <code>ignore add</code> command.<br>Allows to specify rule name.</td></tr></tbody></table> <p><strong>Examples:</strong></p> <ol><li><p>This command adds a file located at <code>/home/user/index.php</code> to Proactive Defense Ignore List for the rule id 12 and name <code>Suspicious detection rule</code>.
It means that Proactive Defense will not analyze this file according to this rule:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent proactive ignore add --path /home/user/index.php --rule-id 12 --rule-name 'Suspicious detection rule'
</code></pre></div></li> <li><p>This command removes files located at <code>&lt;path to file 1&gt;</code> and <code>&lt;path to file 2&gt;</code> from Proactive Defense Ignore List:</p> <div class="language- extra-class"><pre class="language-text"><code>imunify360-agent proactive ignore delete path &lt;path to file 1&gt; &lt;path to file 2&gt;
</code></pre></div></li></ol></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/command_line_interface/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/config_file_description/" class="prev">
          Config File Description
        </a></span> <span class="next"><a href="/uninstall/">
          Uninstall
        </a>
        →
      </span></p></div> </div> <div class="footer" data-v-ac83a848><div data-v-ac83a848><a href="https://cloudlinux.com" data-v-ac83a848><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-ac83a848></a></div> <div data-v-ac83a848>2018. CloudLinux Inc</div> <div data-v-ac83a848><div data-v-ac83a848><a href="https://cloudlinux.zendesk.com/hc/sections/115001344329-How-do-I" target="_blank" data-v-ac83a848>How to</a></div><div data-v-ac83a848><a href="https://imunify360.com/getting-started" target="_blank" data-v-ac83a848>Getting started</a></div><div data-v-ac83a848><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-ac83a848>Contact support</a></div><div data-v-ac83a848><a href="https://www.imunify360.com/blog" target="_blank" data-v-ac83a848>Blog</a></div></div> <div class="social" data-v-ac83a848><span data-v-ac83a848>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-ac83a848><img src="/fb.svg" data-v-ac83a848></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-ac83a848><img src="/tw.svg" data-v-ac83a848></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-ac83a848><img src="/in.svg" data-v-ac83a848></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-ac83a848><img src="/ytube.svg" data-v-ac83a848></a></div></div> <!----></div></div>
    <script src="/assets/js/app.82cee872.js" defer></script><script src="/assets/js/8.6619a899.js" defer></script>
  </body>
</html>
