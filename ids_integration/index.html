<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>IDS Integrations | Documentation</title>
    <meta name="description" content="Kernelcare documentation">
    
    
    <link rel="preload" href="/assets/css/0.styles.5ccae1ef.css" as="style"><link rel="preload" href="/assets/js/app.82cee872.js" as="script"><link rel="preload" href="/assets/js/13.d0200ffb.js" as="script"><link rel="prefetch" href="/assets/js/10.b51fe28b.js"><link rel="prefetch" href="/assets/js/11.e6dc8b34.js"><link rel="prefetch" href="/assets/js/12.4bcb335d.js"><link rel="prefetch" href="/assets/js/14.555a9df0.js"><link rel="prefetch" href="/assets/js/15.e307524e.js"><link rel="prefetch" href="/assets/js/16.1cca512c.js"><link rel="prefetch" href="/assets/js/17.a68b8f5e.js"><link rel="prefetch" href="/assets/js/18.3419b333.js"><link rel="prefetch" href="/assets/js/19.233ab1aa.js"><link rel="prefetch" href="/assets/js/20.2c54de63.js"><link rel="prefetch" href="/assets/js/3.4eb84044.js"><link rel="prefetch" href="/assets/js/4.b81ccb47.js"><link rel="prefetch" href="/assets/js/5.3d4a6f6f.js"><link rel="prefetch" href="/assets/js/6.3a9c5751.js"><link rel="prefetch" href="/assets/js/7.b3aaff77.js"><link rel="prefetch" href="/assets/js/8.6619a899.js"><link rel="prefetch" href="/assets/js/9.48f2c7f5.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.28e1d2e5.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5ccae1ef.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.svg" alt="Documentation" class="logo"> <span class="site-name can-hide">Documentation</span></a> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value="Search"> <!----></div> <div class="links" style="max-width:nullpx;"><a href="https://www.imunify360.com/trial" target="_blank" class="btn">
      Try Free
    </a> <nav class="nav-links can-hide"></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>Content</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/introduction/" class="sidebar-link">Introduction</a></li><li><a href="/terminology/" class="sidebar-link">Terminology</a></li><li><a href="/billing/" class="sidebar-link">Billing</a></li><li><a href="/installation/" class="sidebar-link">Installation Guide</a></li><li><a href="/ids_integration/" class="active sidebar-link">IDS Integrations</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/ids_integration/#csf-integration" class="sidebar-link">CSF Integration</a></li><li class="sidebar-sub-header"><a href="/ids_integration/#cxs-integration" class="sidebar-link">CXS Integration</a></li><li class="sidebar-sub-header"><a href="/ids_integration/#cloudflare-support-3-8" class="sidebar-link">Cloudflare support</a></li></ul></li><li><a href="/backup_providers_integration/" class="sidebar-link">Backup Providers Integration</a></li><li><a href="/localization/" class="sidebar-link">Localization</a></li><li><a href="/captcha/" class="sidebar-link">Captcha</a></li><li><a href="/dashboard/" class="sidebar-link">Imunify360 User Interface</a></li><li><a href="/hosting_panels_specific_settin/" class="sidebar-link">Hosting Panels Firewall Rulsets Specific Settings</a></li><li><a href="/config_file_description/" class="sidebar-link">Config File Description</a></li><li><a href="/command_line_interface/" class="sidebar-link">Command-line Interface</a></li><li><a href="/uninstall/" class="sidebar-link">Uninstall</a></li><li><a href="/faq_and_known_issues/" class="sidebar-link">FAQ and Known Issues</a></li><li><a href="/whmcs_plugin/" class="sidebar-link">Imunify360 WHMCS Plugin</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="ids-integrations"><a href="#ids-integrations" aria-hidden="true" class="header-anchor">#</a> IDS Integrations</h1> <h2 id="csf-integration"><a href="#csf-integration" aria-hidden="true" class="header-anchor">#</a> CSF Integration</h2> <p><a href="https://www.configserver.com/cp/csf.html" target="_blank" rel="noopener noreferrer">ConfigServer Security &amp; Firewall (CSF)<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> integration is intended to allow to use CSF along with Imunify360.</p> <p>If CSF is <strong>disabled</strong> then Imunify360 becomes a primary IDS.</p> <ul><li>White List is loaded from CSF. Imunify360 and CSF work without any additional actions.</li> <li>Gray List is not imported from CSF but it is possible to view and manage Gray List in Imunify360 interface. All changes <strong>will not</strong> be automatically exported to CSF.</li> <li>Black List is not imported from CSF but it is possible to view and manage Black List in Imunify360 interface. All changes <strong>will not</strong> be automatically exported to CSF.</li></ul> <p>If CSF is <strong>enabled</strong> Imunify360 uses Login Failure Daemon (LFD) as source for security events instead of <a href="https://www.ossec.net" target="_blank" rel="noopener noreferrer">OSSEC<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. CSF integration is enabled automatically when Imunify360 detects that CSF is running. No additional configuration is needed.</p> <ul><li>Black List, Gray List, and White List can be managed in Imunify360 regardless of CSF.</li> <li>CSF Allow, Deny and Ignore Lists are not automatically imported from CSF. They can still be managed using CSF interface.</li> <li>Imunify360 will not block addresses from CSF Allow and Ignore Lists.</li></ul> <p><img src="/images/firewallblacklistwarning_zoom70.png" alt></p> <p>It is possible to enable CSF when Imunify360 is already running. All IP addresses from Imunify360 White List will be exported to CSF ignore list. In about 30 seconds after CSF started, Imunify360 switches to CSF Integration mode.</p> <p>To check if CSF integration is enabled go to Imunify360 → Firewall tab → White List section and check if there is a warning message &quot;<em>CSF is enabled. Please manage IPs whitelisted in CSF using CSF user interface or config file</em>&quot;. It means that CSF and Imunify360 integration processed successfully.</p> <p>To get events from Login Failure Daemon (LFD), Imunify360 automatically replaces BLOCK_REPORT variable to the file path of Imunify360 script.
In CSF integration mode, when some IP address is blocked by LFD, Imunify360 adds this IP address to its Graylist and then <strong>removes it from CSF’s deny/tempdeny lists</strong>. The latter is done to allow IP to have access to the Captcha and to store all automatically blocked IP addresses in a single place. Thus, no IP automatically added to CSF deny/tempdeny lists.</p> <p><strong>Mod_security recommendations</strong></p> <p>When mod_security is configured with SecRuleEngine On (blocking mode), CSF blocks IP addresses by mod_security events. The number of events to block IP address is defined by <code>LF_MODSEC</code> variable in <code>csf.conf</code>. This can lead to a large number of false positives.</p> <p>We recommend to set <code>LF_MODSEC</code> variable to 0.</p> <p>In this case, Imunify360 will block IPs only by mod_security events with high severity.</p> <h2 id="cxs-integration"><a href="#cxs-integration" aria-hidden="true" class="header-anchor">#</a> CXS Integration</h2> <p><a href="https://configserver.com/cp/cxs.html" target="_blank" rel="noopener noreferrer">ConfigServer eXploit Scanner<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (CXS) has different types of malware scanning, which affects Imunify360 Malware Scanner functionality. Below we describe how to make Imunify360 Malware Scanner work properly. These functionalities can be configured at <a href="/dashboard/#settings">Malware Scanner settings</a> page, but CXS itself must be configured  as follows:</p> <ol><li><p><em>Automatically scan all modified files</em></p> <p>CXS Watch daemon must be disabled.</p></li> <li><p><em>Automatically scan any files uploaded using web</em></p> <p>CXS ModSecurity vendor should be disabled.</p></li> <li><p><em>Automatically scan any file uploaded using ftp</em></p> <p>Imunify360 supports only <a href="https://www.pureftpd.org" target="_blank" rel="noopener noreferrer">Pure-FTPd<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. For Pure-FTPd CXS launches pure-uploadscript for the scan. Any pure-uploadscript used by CXS must be disabled.</p></li> <li><p><em>On-Demand scanning</em></p> <p>This type of scanning can be always run by Imunify360 and CXS separately. No special actions required.</p></li></ol> <div class="tip custom-block"><p class="custom-block-title">Note</p> <p>Imunify360 doesn’t make any imports from CXS.</p></div> <h2 id="cloudflare-support-3-8"><a href="#cloudflare-support-3-8" aria-hidden="true" class="header-anchor">#</a> Cloudflare support <sup>3.8+</sup></h2> <p><strong><em>Starting from version 3.8, Imunify360 supports graylisting IP addresses behind Cloudflare.</em></strong></p> <p>This is implemented by using Imunify360 WebShield reverse proxy. All traffic from Cloudflare IP addresses is redirected to the WebShield using iptables rules.
WebShield detects real visitor's IP address using CF-Connecting-IP and X-Forwarded-For headers, then forwards request to the backend for the valid IP addresses and shows captcha to graylisted IP addresses.</p> <p>Cloudflare support is disabled by default. To enable it, add the following section to the Imunify360 config file (<em>/etc/sysconfig/imunify360/imunify360.config</em>):</p> <div class="language- extra-class"><pre class="language-text"><code>WEBSHIELD:
  known_proxies_support: true
</code></pre></div></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/cloudlinux/imunify360-doc/edit/dev/docs/ids_integration/README.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <!----></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/installation/" class="prev">
          Installation Guide
        </a></span> <span class="next"><a href="/backup_providers_integration/">
          Backup Providers Integration
        </a>
        →
      </span></p></div> </div> <div class="footer" data-v-ac83a848><div data-v-ac83a848><a href="https://cloudlinux.com" data-v-ac83a848><img src="/assets/img/we-are-cloudlinux.783ed390.svg" alt="We are Cloudlinux" data-v-ac83a848></a></div> <div data-v-ac83a848>2018. CloudLinux Inc</div> <div data-v-ac83a848><div data-v-ac83a848><a href="https://cloudlinux.zendesk.com/hc/sections/115001344329-How-do-I" target="_blank" data-v-ac83a848>How to</a></div><div data-v-ac83a848><a href="https://imunify360.com/getting-started" target="_blank" data-v-ac83a848>Getting started</a></div><div data-v-ac83a848><a href="https://cloudlinux.zendesk.com/hc/en-us/requests/new" target="_blank" data-v-ac83a848>Contact support</a></div><div data-v-ac83a848><a href="https://www.imunify360.com/blog" target="_blank" data-v-ac83a848>Blog</a></div></div> <div class="social" data-v-ac83a848><span data-v-ac83a848>Stay in touch</span> <a href="https://www.facebook.com/imunify360/" target="_blank" data-v-ac83a848><img src="/fb.svg" data-v-ac83a848></a><a href="https://twitter.com/imunify360/" target="_blank" data-v-ac83a848><img src="/tw.svg" data-v-ac83a848></a><a href="https://linkedin.com/company/cloudlinux" target="_blank" data-v-ac83a848><img src="/in.svg" data-v-ac83a848></a><a href="https://www.youtube.com/channel/UCcW6dDJjcy41c7Hl_5LdLZQ" target="_blank" data-v-ac83a848><img src="/ytube.svg" data-v-ac83a848></a></div></div> <!----></div></div>
    <script src="/assets/js/app.82cee872.js" defer></script><script src="/assets/js/13.d0200ffb.js" defer></script>
  </body>
</html>
